(this.$WP=this.$WP||[]).push(["DFY5B4",(e,t)=>{"use strict";var o,a,s,i,n,r,l,d,c,h,u,p,v,w,S,g,M,k,f,m,L,I,O,C,A,B,E,P,N,R=e=>e.showMap&&a(c,{onClose:e.closeMap},a(B,{locationId:e.locationId},({location:t,loading:o})=>o?a("div",{className:"_3AZdLNvs"},a(h,null)):t?a("div",{className:"_3VHA2x07"},a(P,{detailLocation:t,onClose:e.closeMap})):null)),y=e=>"#MAPVIEW-"+e,b=(e,t)=>{"function"==typeof e&&e(window&&window.location&&window.location.hash===y(t))},_=(e,t,o)=>{window&&window.history.pushState(null,document.title,y(o)),e(!1),b(t,o)},x=(e,t,o,a)=>{e?(window&&window.history.back(),b(o,a)):((()=>{var e=window&&window.location.toString();if(e&&e.indexOf("#")>0){var t=e.substring(0,e.indexOf("#"));window.history.replaceState(null,document.title,t)}})(),b(o,a)),t&&t(!1)},D=e=>{var[t,o]=i(!1),[s,l]=i(!1),c=n(()=>_(o,l,e.locationId),[o,l,e.locationId]),h=n(()=>x(t,void 0,l,e.locationId),[t,l,e.locationId]);return r(()=>{var e=d("ar-map");e&&e.on("open-trigger-clicked",c),e&&e.on("close-trigger-clicked",h);var t=d("hr-map");return t&&t.on("open-trigger-clicked",c),t&&t.on("close-trigger-clicked",h),window&&(window.addEventListener("popstate",b),window.addEventListener("hashchange",b,!1)),function(){window&&(window.removeEventListener("popstate",b),window.removeEventListener("hashchange",b)),e&&e.off("open-trigger-clicked",c),t&&t.off("open-trigger-clicked",c)}},[c,h]),a(R,{locationId:e.locationId,showMap:s,closeMap:h})},F=e=>{var[t,o]=i(!1),[s,n]=i(!1);return e.openMap&&!s&&_(o,n,e.locationId),r(()=>(b(n,e.locationId),function(){}),[e.locationId]),a(R,{locationId:e.locationId,showMap:s,closeMap:()=>x(t,e.toggleOpenMap,n,e.locationId)})};return[()=>{B=class extends o{render(){var e="/data/1.0/mapsEnrichment/attraction/"+this.props.locationId;return a(u,{url:e},({loading:e,data:t,error:o})=>a(s,null,this.props.children({loading:e,location:t,error:o})))}},E=class extends o{constructor(e){super(e),this.onMapLoaded=e=>{this.setState({mapInterface:e.map,lastSearchBBox:e.map.getBounds()})},this.onMapClick=()=>{this.setState({selectedMarker:null,hoveredMarker:null,carouselState:"hidden"})},this.onLocationHoverStart=e=>{"DESKTOP"===this.props.viewportCategory&&this.setState(()=>({hoveredMarker:e}))},this.onLocationHoverEnd=e=>{this.setState(t=>t.hoveredMarker&&t.hoveredMarker.id===e.id?{hoveredMarker:null}:null)},this.onPinSelected=e=>{if(e){var t=this.props.detailLocation===e?"primary_pin":"selected_marker";this.state.visitedLocations[e.id]=!0,this.setState({selectedMarker:e,hoveredMarker:null,carouselState:t})}else this.setState({selectedMarker:null,hoveredMarker:null,carouselState:"hidden"})},this.onRedoSearch=()=>{var{mapInterface:e}=this.state;if(e){var t=e.getBounds();this.setState({lastSearchBBox:t})}},this.toggleAlsoShowOption=(e,t)=>{var o=Object.assign({},this.state.selectedAlsoShowOptions);o[e]=t,this.setState({selectedAlsoShowOptions:o}),t&&this.onRedoSearch()},this.clearAlsoShowOptions=()=>{var{carouselState:e}=this.state;"selected_marker"===e&&(e="hidden"),this.setState({selectedAlsoShowOptions:{},carouselState:e})},this.state={mapInterface:null,hoveredMarker:void 0,selectedMarker:void 0,carouselState:"hidden",selectedAlsoShowOptions:{[p.hotels]:!0,[p.restaurants]:!0,[p.thingsToDo]:!0},visitedLocations:{},lastSearchBBox:null,hasFitResults:!1},"MOBILE"===e.viewportCategory&&e.detailLocation&&(this.state.carouselState="selected_marker",this.state.selectedMarker=e.detailLocation)}componentDidUpdate(){if(!this.state.hasFitResults){var{mapInterface:e}=this.state;e&&this.setState({hasFitResults:!0})}}render(){var{detailLocation:e,onClose:t}=this.props,{selectedMarker:o,hoveredMarker:s,selectedAlsoShowOptions:i,visitedLocations:n,hasFitResults:r}=this.state,l=s?s.id:0,d=o?o.id:0,c="DESKTOP"===this.props.viewportCategory,h="MOBILE"===this.props.viewportCategory,u=Object.keys(i).filter(e=>i[e]).length>0,B=null;"hidden"!==this.state.carouselState&&o&&(B=[o]);var E=h&&B&&B.length;return a("div",{className:"_1tMJWuLn"},a(S,{locationName:e.name,onClose:t}),a(I,{initialCenter:new L(e.geoPoint.latitude,e.geoPoint.longitude),initialZoom:15,onLoad:this.onMapLoaded,onClick:this.onMapClick},a(O,{locations:[e],hoveredMarker:l,selectedMarker:d,visited:{},showSelectedMarker:h,onMouseEnter:this.onLocationHoverStart,onMouseLeave:this.onLocationHoverEnd,onClick:this.onPinSelected}),a("div",{className:"eq5eKTrq"}),c&&!!s&&s!==o&&a(A,{location:s}),c&&o&&a(C,{location:o,autoPan:!0}),a(w,{blacklist:{[e.id]:!0},showSelectedMarker:h,selectedMarker:d,hoveredMarker:l,boundingBox:this.state.lastSearchBBox,isVisited:n,showRestaurants:i[p.restaurants],showAttractions:i[p.thingsToDo],showHotels:i[p.hotels],onMarkerMouseEnter:this.onLocationHoverStart,onMarkerMouseLeave:this.onLocationHoverEnd,onMarkerClick:this.onPinSelected}),E&&a(k,{locations:B||[],selectedMarker:d,onSwipe:()=>{}}),a("div",{className:"_1aZN50nm"},a(g,null)),a("div",{className:"_3uZrUncY "+(E?"iJblIe3F":"")},a(v,{options:[p.hotels,p.restaurants,p.thingsToDo],selectedValues:this.state.selectedAlsoShowOptions,onValueChange:this.toggleAlsoShowOption,onClearOptions:this.clearAlsoShowOptions})),u&&r&&a("div",{className:"X0moYFrN"},a(h?M:f,{onRedoSearch:this.onRedoSearch})),a("div",{className:"_5scWpi5a "+(E?"iJblIe3F":"")},a(m,null))))}},P=l((e,t)=>Object.assign({},t,{viewportCategory:e.meta.device.viewportCategory}))(E),N=l(e=>({locationId:e.page.detailId,geoId:e.page.geoId}))(D),e("default",N),e("AttractionReviewMap",F)},[e=>(o=e.PureComponent,a=e.createElement,s=e.Fragment,i=e.useState,n=e.useCallback,r=e.useEffect),e=>l=e.connect,e=>d=e.default,e=>c=e.default,e=>h=e.LoadingSpinner,e=>u=e.default,e=>(p=e.AlsoShowValues,v=e.AlsoShowControl),e=>w=e.default,e=>S=e.default,e=>g=e.default,e=>M=e.default,e=>k=e.default,e=>f=e.RedoSearchButton,e=>m=e.default,e=>L=e.LatLng,e=>I=e.default,e=>O=e.AnchorMarkers,e=>C=e.default,e=>A=e.default]]},["cDcdfi","h74DsO","l6BSGt","A7p4Ig","V08PS7","w_dosq","R57Q-B","7XASeK","cNT73m","KB4cfU","ue1PHu","l7q5Ts","R4dv1u","wbt5GG","VwUieX","UaLTva","Xolfce","IdKzX3","uWGJsK"]]);
