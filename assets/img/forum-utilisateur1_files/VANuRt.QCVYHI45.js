(this.$WP=this.$WP||[]).push(["VANuRt",(e,r)=>{"use strict";var o,a,l,t,s,n,i,c,d,u,p,f,h,v,m,g=({options:e,onReady:r,onShowOverlay:n})=>{var[i,c]=o(),[u,p]=o(),[f,h]=o(!1),{onSuccess:v,isFullWidthMobile:g}=e,w=a(e=>{var r,o=e.resultData||"";if(o){var a=(e=>{var r={};try{r=JSON.parse(e)}catch(r){return console.error("Error parsing controller result data: "+e),null}return"object"!=typeof r?(console.error("Parsed controller result is not an object."),null):{userId:r.user_id,hasCreatedMember:!!r.hasCreatedMember,hasAcceptedTermsOfUse:!!r.hasAcceptedTermsOfUse}})(o);null==a||a.hasCreatedMember,v&&v(a)}else v&&v(null);e.jsCallback&&(r=e.jsCallback)&&console.error("Non-empty JSCallback is returned from RegController: "+r)},[v]),{viewportCategory:y}=l(d),O=a(e=>{e>100&&c("MOBILE"===y&&g?"100%":e)},[y,g]),{displayOnShowOverlay:b,onClose:C}=e,S=a(e=>{var o=e,a=(e=>{if(!e)return null;if(!e.origin||0!==e.origin.indexOf("https")||e.origin!==document.location.origin)return null;if(!e.data||!e.data.indexOf||-1===e.data.indexOf("action"))return null;try{var r=JSON.parse(e.data);return r.action?r:null}catch(e){return null}})(o);if((e=>{e&&e.origin&&0===e.origin.indexOf("https://smartlock.google.com")&&e.data&&e.data.type&&e.source&&e.source.postMessage({type:"verifyAck",data:e.data.data},"https://smartlock.google.com")})(o),a){var{action:l}=a;switch(l){case"successClose":w(a);break;case"reloadWindow":console.error("Unexpected reload window message is received from RegController iframe");break;case"fwdToRelativeUrl":var t=a.url||"";t||console.error("No url specified to forward to."),0!==t.indexOf("/")&&console.error("Cannot forward to absolute url: "+t),window.location=t;break;case"resizeFrame":O(a.width),a.height>100&&p(a.height);break;case"domReady":h(!0),r&&r();break;case"dismiss":C&&C();break;case"showOverlay":b&&n&&n()}}},[w,b,n,C,r,O]);m("message",S);var k=t(()=>{var r=new URLSearchParams(Object.assign({flow:e.flow,flowOrigin:e.flowOrigin,pid:""+e.pid,hideNavigation:"true",userRequestedForce:"true",returnTo:""},e.extraQueryParams||{}));return e.mcid&&r.append("mcid",""+e.mcid),e.locationId&&r.append("locationId",""+e.locationId),e.stateToken&&r.append("stateToken",e.stateToken),void 0!==e.requireSecure&&r.append("requireSecure",""+String(!!e.requireSecure)),"/RegistrationController?"+r.toString()},[e.extraQueryParams,e.flow,e.flowOrigin,e.locationId,e.mcid,e.pid,e.requireSecure,e.stateToken]);return s("div",{className:"_8RLaCUf_",style:{width:i,height:u}},s("iframe",{className:"_30pzQStV",src:k,title:"regcontroller",style:{width:i,height:u,display:f?"block":"none"},scrolling:"no"}))},w=({options:e,closeX:r})=>{var[l,n]=o(!1),i=a(()=>{e.displayOnShowOverlay||n(!0)},[e.displayOnShowOverlay]),c=a(()=>{n(!0)},[]),d=t(()=>s(g,{options:e,onReady:i,onShowOverlay:c}),[i,e,c]);return s(h,{onClose:e.onClose,containerProps:{backgroundColor:"transparent",disableBodyScroll:!0},bodyProps:{isFullBleed:!0},enableCloseIcon:l&&r},s("div",{style:{display:l?"block":"none"}},d),!l&&s("div",{className:"nUBQ6pZw"},s(v,{size:"large",inverted:!0})))},y=()=>{var{userId:e}=l(u),[r]=l(p),t=l(f),d=r.params.geoId||void 0,[h,v]=o({flow:"CORE_COMBINED",flowOrigin:"join",pid:-1}),[m,g]=o({closeX:!0}),y=c(),O=n(void 0),b=i(()=>s(w,{options:h,closeX:m.closeX}),{},[h,m]);return a(r=>e&&!r.forceLogin?Promise.resolve({userId:e,hasCreatedMember:null}):(O.current||(O.current=new Promise(e=>{v({flow:r.flow||"CORE_COMBINED",flowOrigin:r.flowOrigin||"join",pid:r.pid||-1,isFullWidthMobile:r.isFullWidthMobile||!1,extraQueryParams:r.extraQueryParams||{},displayOnShowOverlay:r.deferShowOverlay,locationId:d||-1,onSuccess:o=>{var a={userId:(null==o?void 0:o.userId)||null,hasCreatedMember:!!(null==o?void 0:o.hasCreatedMember)};r.onSuccess&&r.onSuccess(a),b.close(),O.current=null,t({userId:a.userId}),e(a)},onClose:()=>{y({module:"regoverlay",action:"closed",context:[d||"",r.flow].join("|"),value:r.pid||void 0,nonInteraction:!1}),b.close(),O.current=null,r.onClose&&r.onClose()}}),g({closeX:!1!==r.closeX}),b.open()})),O.current),[e,r.path,d,b,t,y])};return[()=>{e("default",y)},[e=>(o=e.useState,a=e.useCallback,l=e.useContext,t=e.useMemo,s=e.createElement,n=e.useRef),e=>i=e.useVDOMPortal,e=>c=e.useGARecorder,e=>(d=e.Device,u=e.Visitor,p=e.Route,f=e.Authenticate),e=>h=e.default,e=>v=e.LoadingSpinner,e=>m=e.useWindow]]},["cDcdfi","vq6MSq","fsml46","2R4xv2","O8LbtK","V08PS7","Dg5_-9"]]);
