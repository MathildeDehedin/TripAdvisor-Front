(this.$WP=this.$WP||[]).push(["2_vy--",(e,r)=>{"use strict";var a,i,t,n,o,s,l,d,p,u,c,m,v,h,k,_,N,y,T,b,f,C,g,S,P,I,U,w,A,R,z,L,D,E,O=e=>{var r=e.size||"default",i=e.tabletSize?(e.tabletSize||"default")+"-tablet":null;return a("span",{onClick:e.onClick,ref:e.targetRef,className:s("_2Bft2ZdY","ui_social_avatar",r,i)},a(o,{className:"_3WFlr_f3",name:"plus"}))},V={READ:()=>m(v("trips_share_read_only",{className:"_2Yyc82oA"})),WRITE:()=>m(v("trips_share_read_write",{className:"_2Yyc82oA"})),PUBLIC:()=>m(v("trips_share_read_only",{className:"_2Yyc82oA"}))},W=({trip:e,shareType:r,alignEdge:i,onClick:t,repostProps:n})=>a(R,{trip:e,shareType:r,alignEdge:i,repostProps:n},(r,i,n)=>a(S,{itemType:"Trip",itemId:""+e.id,url:n,action:"share_button_click"},()=>a(A,null,e=>a(P,{onClick:r=>{t&&t(),e(r,"share"),i()},target:r,styleAsSocialAction:!0})))),F=({user:e,contextNode:r,avatarNotLazy:i})=>{var t="/Profile/"+e.username,n=a(u,{notLazy:i,size:"default",href:t,withBorder:!0,photo:e.avatar,mobileTarget:"_self"});return a("div",{className:"_2r6URqGV"},n,a("a",{href:t,className:s("_2RbhQorQ","ui_link")},e.displayName),r&&a("div",{className:"_3UfSruul"},r))},x=({trip:e,onClick:r})=>a(R,{shiftArrow:7,trip:e,shareType:"WRITE"},(e,i)=>{var t=()=>{i(),r&&r()};return a("div",{className:s("_2r6URqGV","_3PSaIF1K")},a(O,{onClick:t,targetRef:e}),a("div",{onClick:t,className:s("_2TZ7bRck","ui_link")},v("trips_add_CTA")))});return[()=>{O.defaultProps={size:"default",tabletSize:void 0,onClick:void 0},(L=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"mutation","name":{"kind":"Name","value":"CreateTripToken"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"tripId"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"Int"}}},"directives":[]},{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"type"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"TripTokenTypeInput"}}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"createTripToken"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"tripId"},"value":{"kind":"Variable","name":{"kind":"Name","value":"tripId"}}},{"kind":"Argument","name":{"kind":"Name","value":"type"},"value":{"kind":"Variable","name":{"kind":"Name","value":"type"}}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"route"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"url"},"arguments":[],"directives":[]}]}}]}}]}}],"loc":{"start":0,"end":162}}')).__key=0xab506ed2050e,L.loc.source={body:"ab506ed2050e"},e("ShareTripPopup",R=class extends i{constructor(e){super(e);var r=e.trip.route&&e.trip.route.url||T(e.trip.id),a="PUBLIC"===e.shareType?r:"";this.state={shareUrl:a,shareUrlType:e.shareType}}onTargetClick(e,r){this.state.shareUrl&&this.state.shareUrlType===this.props.shareType||this.updateShareUrl(e),r()}updateShareUrl(e){"PUBLIC"!==this.props.shareType?e({variables:{tripId:this.props.trip.id,type:this.props.shareType}}).then(e=>{var r,a,i;this.setState({shareUrl:null==e||null==(r=e.data)||null==(a=r.createTripToken)||null==(i=a.route)?void 0:i.url,shareUrlType:this.props.shareType})}):this.setState({shareUrl:T(this.props.trip.id),shareUrlType:"PUBLIC"})}renderContent(){var{shareUrl:e}=this.state,{trip:r}=this.props,{repostProps:i}=this.props,n=V[this.props.shareType](),o="WRITE"===this.props.shareType?"WriteTrip":"ReadTrip";return b(r)||r&&r.actionPermissions&&r.actionPermissions.canEdit||(n=null,o="NotMyTrip"),e?a(t,null,n&&a("div",{className:"_2yVZkHZ0"},n),a(g,{url:e,itemType:o,itemId:""+r.id,repostProps:i})):a(U,{size:"small"})}render(){var{closeOnScroll:e}=this.props;return a(I,{local:!0,closeButton:!1,below:!0,alignEdge:this.props.alignEdge,arrowType:"small",shiftArrow:this.props.shiftArrow,contents:()=>this.renderContent()},(r,i,n)=>a(t,null,e&&a(w,{callback:n,throttle:500}),a(d,{mutation:L},e=>this.props.children(r,()=>this.onTargetClick(e,i),this.state.shareUrl,n))))}}),R.defaultProps={alignEdge:"left",shiftArrow:0,closeOnScroll:!1},W.defaultProps={onClick:void 0},(D=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"mutation","name":{"kind":"Name","value":"RemoveCollaborator"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"collaboratorId"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"Int"}}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"deleteTripCollaborator"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"collaboratorId"},"value":{"kind":"Variable","name":{"kind":"Name","value":"collaboratorId"}}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"id"},"arguments":[],"directives":[]}]}}]}}],"loc":{"start":0,"end":134}}')).__key=0xa408ef7ff35d,D.loc.source={body:"a408ef7ff35d"},e("CollaboratorPanel$1",z=class extends n{constructor(...e){super(...e),this.getContextNode=(e,r,a)=>{var i=f(r,!1);return(null==i?void 0:i.canRemove)?this.renderConfirmationAndContent(r,a):null},this.renderConfirmationAndContent=(e,r)=>{var i,t,n,{user:o={}}=e;o.isMe?(i=v("trips_leave_trip_modal_header"),t=v("trips_leave_trip_modal_body"),n=v("trips_leave_CTA")):(i=v("trips_remove_collaborator_modal_header"),t=v("trips_remove_collaborator_modal_body"),n=v("trips_remove_CTA"));var s=n,l=v("stat_modal_cancel"),d=()=>r(e),p=null;return this.props.isNativeWebview&&(p=()=>_.showNativeOverflowMenu({treatment:"alert",title:i,subtitle:t,items:[{title:l,tapCallback:()=>{}},{preferred:!0,title:s,destructive:!0,tapCallback:d}]})),a(c,{header:i,description:t,cancel:l,confirm:s,above:!0,alignEdge:"right",shiftY:30,onConfirm:d,onCancel:null},(r,i)=>a("div",{ref:r,onClick:()=>{(p||i)(),this.props.onRemoveShow&&this.props.onRemoveShow(e)},className:"_2YU0Meca"},n))}}renderPanel(e){var{props:r}=this,{collaborators:i}=r.trip,t=a("div",{className:"_273KruGC"},v("trips_owner")),n=C(r.trip,!1);return a("div",{className:"_2AQ5ojDv"},(null==n?void 0:n.canAddCollaborators)&&!r.readOnly&&a(x,{trip:r.trip,onClick:r.onAddCollaboratorClick}),a("div",{className:"lwu-oKFO"},r.trip.owner&&a(F,{user:r.trip.owner,contextNode:t,avatarNotLazy:r.avatarNotLazy}),i&&i.map(i=>i.user&&a(F,{key:i.userId,user:i.user,avatarNotLazy:r.avatarNotLazy,contextNode:!r.readOnly&&this.getContextNode(r.trip,i,e)}))))}render(){return y("trips_2018_collab")?a(N,null,({navigate:e})=>a(h,null,r=>a(d,{mutation:D,refetchQueries:this.props.refetchQueries,awaitRefetchQueries:!0,onError:e=>p.error(e)},i=>this.renderPanel(t=>{this.props.onRemove&&this.props.onRemove(t),i({variables:{collaboratorId:t.id}}).then(()=>{var i=t.user&&t.user.isMe;if("PUBLIC"!==this.props.trip.status&&i)e({page:"Trips"});else{var n=t.user&&t.user.displayName||v("trips_unknown_user");r({node:a(k,null,v("trips_collaborator_removed_confirm",{UserName:n}))})}})})))):null}}),z.defaultProps={isNativeWebview:!1,refetchQueries:[],readOnly:!1,onRemoveShow:void 0,onRemove:void 0,avatarNotLazy:!1},E=l(e=>({loggedInUserId:e.auth.loggedInUserId,isNativeWebview:e.meta.isNativeWebview}))(z),e({AddFriendIcon:O,CollaboratorPanel:E,ShareTripPopup:R,ShareTripPopupAction:W})},[e=>(a=e.createElement,i=e.Component,t=e.Fragment,n=e.PureComponent),e=>o=e.Icon,e=>s=e.default,e=>l=e.connect,e=>d=e.Mutation,e=>p=e.default,e=>u=e.Avatar,e=>c=e.ConfirmationPopover,e=>(m=e.unescaped,v=e.localize),e=>(h=e.ToastConsumer,k=e.ToastItem),e=>_=e.NativeBridge,e=>N=e.RouteConsumer,e=>y=e.featureIsEnabled,e=>(T=e.buildPublicTripShareUrl,b=e.isOwner,f=e.getCollabPermissions,C=e.getTripPermissions),e=>(g=e.ShareDropdownMenu,S=e.ShareTracker,P=e.ShareTarget),e=>I=e.default,e=>U=e.LoadingSpinner,e=>w=e.default,e=>A=e.InteractionLogger]]},["cDcdfi","_qQcW3","jSLlaY","h74DsO","MGkW-Q","4LU1Ax","Hgrhyo","H__Mj2","535agn","Q7TAd7","Ov85iR","N4pTU2","-i3PJS","eFKnUp","ui0Mdg","eDFcUX","V08PS7","w4JHTr","pZzSdK"]]);
