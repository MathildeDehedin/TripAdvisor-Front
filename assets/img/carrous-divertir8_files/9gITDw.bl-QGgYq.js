(this.$WP=this.$WP||[]).push(["0s-BIP/9gITDw",(e,t)=>{"use strict";var a,i,n,r,d,l,o,c,u,s,m,g,k,p,v,_,T,y,N,b,I,S,O,E,f,h,C,P="ar_xsell_shelf_attraction_product",L=e=>({productCode:e.productCode,rating:e.rating,reviewCount:e.reviewCount,price:e.fromPriceTracking,currency:e.currency}),D=e=>({productCode:e.attractionProductCode,rating:e.rating,reviewCount:e.reviewCount||0,price:e.priceFrom||0,currency:e.currencyCode||""}),A=e=>t=>{var{tab:a,position:i,tabIdTag:n}=e;return Object.assign({},t,{tab:a,position:i,tabIdTag:n})},R=({locationId:e})=>i(c,{locationId:e,trackingModule:"Shelf",showOnTablet:!0,isDesktop:!0}),M=(e,t)=>({showMoreInfoButton:m("attractions_ar_wte_more_info_button"),cardStyle:t,hoverComponent:i(R,{locationId:e}),linkOptions:{target:"_blank"}}),F=e=>{if(!e||0===e.length)return null;var t=e[0];return{localizedText:(null==t?void 0:t.label)||"",labelType:null==t?void 0:t.labelType,tagProperty:"BEST_SELLER"===(null==t?void 0:t.labelType)?"primary":"secondary"}},x=(e,t)=>(a,i,n)=>a.filter((e,t)=>t<O).map((r,d)=>{var l;return{product:{locationId:r.activityId||0,placement:d,shelfIndex:i,productLabelTag:F(r.productLabelTags),url:(null==(l=r.canonicalRoute)?void 0:l.url)||"",productId:r.attractionProductId,productCode:r.attractionProductCode,title:r.name||"",fromPrice:r.displayPriceNoRounding||"",strikethruPrice:r.hasValidStrikeThruPrice&&r.displayStrikeThruPriceNoRounding||"",rating:r.rating||0,percentOff:r.rating||0,reviewCount:r.reviewCount||0,imgUrl:r.imageUrl||"",visibleTrackingProps:{action:"in_view",context:JSON.stringify(A({tabIdTag:"GEOMERCH",position:d,tab:i})(D(r)))}},productOptions:M(r.activityId||0,t(n,a.length)),shelfIndex:i,index:d,layout:e(n,a.length),key:"fragment_"+d,trackingModule:P}}),w=(e,t,a)=>e.filter((e,t)=>t<12).map((e,i)=>({category:Object.assign({},e,{placement:i,shelfIndex:t,itemIndex:i,link:{url:e.apListUrl,isEncoded:!0}}),categoryOptions:{linkOptions:{target:"_blank"}},shelfIndex:t,index:i,layout:"DESKTOP"!==a?S.LAYOUT_HORIZONTAL_SMALL:S.LAYOUT_COLLAPSIBLE_GRID_6XN,key:"fragment_"+i})),U=(e,t)=>(a,i,n)=>a.filter((e,t)=>t<O).map((r,d)=>({product:Object.assign({},r,{placement:d,tabId:"ADMISSIONS",imgUrl:null==r?void 0:r.imageUrl,visibleTrackingProps:{action:"in_view",context:JSON.stringify(A({tabIdTag:"ADMISSIONS",position:d,tab:i})(L(r)))}}),productOptions:{showMoreInfoButton:m("attractions_ar_wte_more_info_button"),cardStyle:t(n,a.length),showTicketIcon:!0,linkOptions:{target:"_blank"}},layout:e(n,a.length),index:d,shelfIndex:i,key:"fragment_"+d,trackingModule:P})),V=(e,t)=>"DESKTOP"===e&&t<=2?"LANDSCAPE_ELONGATED":"SOLID",Y=(e,t)=>"MOBILE"===e?S.LAYOUT_HORIZONTAL_ORIGINAL:"TABLET"===e?S.LAYOUT_HORIZONTAL_SMALL:t<=2?S.LAYOUT_GRID_2XN:3===t?S.LAYOUT_GRID_3XN:S.LAYOUT_COLLAPSIBLE_GRID_4XN,B=(e,t)=>"DESKTOP"===e&&1===t?"TICKETBANNER":"DESKTOP"===e&&2===t?"LANDSCAPE_ELONGATED":"SOLID",G=(e,t)=>1===t&&"DESKTOP"===e?S.LAYOUT_VERTICAL:Y(e,t),j=e=>"category"===e?(e,t)=>"DESKTOP"!==e?S.LAYOUT_HORIZONTAL_SMALL:S.LAYOUT_COLLAPSIBLE_GRID_6XN:"product"===e?Y:G,K=e=>("product"===e?4:"category"===e&&6)||void 0,W=e=>e&&1===e.length&&e[0].productCode,X=e=>1===(null==e?void 0:e.length)&&W(e[0].products),H=e=>i("div",{className:m("attractions_poi_above_the_fold_refresh")?"_10MG_7Z7":"_1YMg4pWG"},I(e.children)),J=e=>{var t,i,c,u,{viewportCategory:T}=a.useContext(k),[I,S]=n(0),{locale:{code:C}}=a.useContext(p),{currency:D}=a.useContext(v),[R]=a.useContext(_),F=y("WAYS_TO_EXPERIENCE_V2"),j="Attraction_Review"===R.page&&R.params.detailId,K=m("attractions_arxsell_geomerch_for_small_tvrm_mapping"),[J]=o({query:E,variables:{currency:D,locale:C,productLimit:8,locationId:j},pause:!K}),{data:Z}=J,$=(null==Z||null==(t=Z.geoInfo)||null==(i=t[0])||null==(c=i.parent)?void 0:c.name)||"",q=((null==Z||null==(u=Z.geomerch)?void 0:u.products)||[]).filter(Boolean),{productTabs:z,categoryTab:Q,tickets:ee}=e,te=r(()=>{return((e,t)=>(e=>{var t=e.productTabs.map(e=>({type:"product",productType:"tvrm",data:e})),a=e.tickets&&{type:"ticket",data:e.tickets},i=e.categoryTab&&{type:"category",data:e.categoryTab},n=e.geoTab&&{type:"product",productType:"geo",data:e.geoTab};if(0===t.length)return[];if(1===t.length&&n&&n.data.products&&n.data.products.length>0)return[t[0],n];var[r,...d]=t,l=a&&a.data.length>0&&[a]||[],o=i&&i.data.categories.length>0&&[i]||[],c=d.slice(0,Math.min(5-l.length-o.length,d.length));return[r,...l,...c,...o]})(e).map((e,a)=>{return"product"===e.type?"tvrm"===e.productType?{type:"product",items:(i=Y,n=V,(e,t,a)=>e.products.filter((e,t)=>t<O).map((r,d)=>{var l,o,c;return{product:Object.assign({},r,{placement:d,imgUrl:(null==r||null==(l=r.thumbnail)||null==(o=l.images)||null==(c=o.large)?void 0:c.url)||"",tabId:""+("RECOMMENDED_PRODUCTS"===e.productType?"RECOMMENDED":e.category.groupTagId),visibleTrackingProps:{action:"in_view",context:JSON.stringify(A({tabIdTag:"RECOMMENDED_PRODUCTS"===e.productType?"RECOMMENDED":e.category.groupTagId,position:d,tab:t})(L(r)))}}),productOptions:M(r.locationId,n(a,e.products.length)),shelfIndex:t,index:d,layout:i(a,e.products.length),key:"fragment_"+d,trackingModule:P}}))(e.data,a,t),title:e.data.category.title,subtitle:e.data.category.subtitle,groupTagId:e.data.category.groupTagId,trackingId:"RECOMMENDED_PRODUCTS"===e.data.productType?"RECOMMENDED":null}:{type:"product",items:x(Y,V)(e.data.products,a,t),title:b("attractions_ways_to_exp_title_geomerch"),subtitle:b("attractions_ways_to_exp_subtitle_geomerch",{geo:e.data.geoName}),trackingId:"GEOMERCH"}:"category"===e.type?{type:"category",items:w(e.data.categories,a,t),trackingId:"BROWSE_BY_CATEGORY"}:{type:"ticket",items:U(G,B)(e.data,a,t),title:b("attractions_ways_to_exp_title_admission_tickets"),subtitle:b("attractions_ways_to_exp_subtitle_admission_tickets"),trackingId:"ADMISSIONS"};var i,n}))({productTabs:z||[],categoryTab:Q,tickets:(e=W(ee),t=X(z),!(e&&t&&e===t)&&ee||[]),geoTab:K&&{geoName:$,products:q.filter(e=>{var t,a;return!!e.activityId&&(null==(t=null==(a=e.canonicalRoute)?void 0:a.typedParams)?void 0:t.detailId)===e.activityId})}},T);var e,t},[z,ee,Q,$,q,T,K]);d(()=>{"DESKTOP"===T&&null===I&&S(0)},[T,I]);var ae=l((e,t)=>a=>{S("DESKTOP"!==T&&t===I?null:t),g(a,{module:"WTE_V2",action:"WTE_V2_tab_click",value:e.groupTagId||0,context:`(${t} | ${e.trackingId||e.groupTagId||"0"})`,once:!0})},[T,I]),ie=s({"_1b-zXYNl":!0,_1iICndOw:m("attractions_poi_above_the_fold_refresh")});return a.createElement(N.Provider,{value:F},a.createElement("div",{id:"WAYS_TO_EXPERIENCE_V2",className:ie,"data-tab":"TABS_TOURS"},e.title&&a.createElement(H,null,e.title),"DESKTOP"===T&&null!==I&&a.createElement(f,{activeTab:I,tabModels:te,onTabClick:ae}),"DESKTOP"!==T&&a.createElement(h,{hintActiveTab:I,tabModels:te,onTabClick:ae})))};return[()=>{O=8,(E=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"query","name":{"kind":"Name","value":"geomerch"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"currency"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"String"}}},"directives":[]},{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"locale"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"String"}}},"directives":[]},{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"productLimit"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"Int"}}},"directives":[]},{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"locationId"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"Int"}}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","alias":{"kind":"Name","value":"geomerch"},"name":{"kind":"Name","value":"TAC_getGeoMerchandisingProductsForAttraction"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"request"},"value":{"kind":"ObjectValue","fields":[{"kind":"ObjectField","name":{"kind":"Name","value":"currencyCode"},"value":{"kind":"Variable","name":{"kind":"Name","value":"currency"}}},{"kind":"ObjectField","name":{"kind":"Name","value":"locale"},"value":{"kind":"Variable","name":{"kind":"Name","value":"locale"}}},{"kind":"ObjectField","name":{"kind":"Name","value":"maxProducts"},"value":{"kind":"Variable","name":{"kind":"Name","value":"productLimit"}}},{"kind":"ObjectField","name":{"kind":"Name","value":"locationId"},"value":{"kind":"Variable","name":{"kind":"Name","value":"locationId"}}}]}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"products"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"attractionProductId"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"activityId"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"attractionProductCode"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"name"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"priceFrom"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"hasValidStrikeThruPrice"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"displayStrikeThruPriceNoRounding"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"displayPriceNoRounding"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"currencyCode"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"rating"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"percentOff"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"reviewCount"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"imageUrl"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"canonicalRoute"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"url"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"typedParams"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"InlineFragment","typeCondition":{"kind":"NamedType","name":{"kind":"Name","value":"Routing_AttractionProductReviewParameters"}},"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"__typename"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"detailId"},"arguments":[],"directives":[]}]}}]}}]}},{"kind":"Field","name":{"kind":"Name","value":"productLabelTags"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"label"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"labelType"},"arguments":[],"directives":[]}]}}]}}]}},{"kind":"Field","alias":{"kind":"Name","value":"geoInfo"},"name":{"kind":"Name","value":"locations"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"locationIds"},"value":{"kind":"ListValue","values":[{"kind":"Variable","name":{"kind":"Name","value":"locationId"}}]}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"parent"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"name"},"arguments":[],"directives":[]}]}}]}}]}}],"loc":{"start":0,"end":951}}')).__key=6118140962115,E.loc.source={body:"05907d9e6543"},f=T.onUsage(()=>t("0s-BIP/GCCE9V"),"default"),h=T.onUsage(()=>t("0s-BIP/a6_lbR"),"default"),C=u((e,t)=>{var a=t("/data/1.0/attraction/ways-to-experience/"+e.page.detailId),i=m("attractions_social_proof_message_on_product_shelves_test"),n=t(`/data/1.0/attractions/products/multitour/tickets/${e.page.detailId}?includeSocialProofTotalBookings=${i}`);return c.stage(e,t),()=>Object.assign({},a.get().data||{},{tickets:n.get().data||[]})})(J),e({W:J,a:C,d:j,m:K})},[e=>(a=e.default,i=e.createElement,n=e.useState,r=e.useMemo,d=e.useEffect,l=e.useCallback),e=>o=e.useQuery,e=>c=e.default,e=>u=e.bind,e=>s=e.default,e=>m=e.featureIsEnabled,e=>g=e.trackClick,e=>(k=e.Device,p=e.Environment,v=e.Preference,_=e.Route),e=>T=e.component,e=>(y=e.useShelfTrackingContext,N=e.ShelfTrackingContext),e=>(b=e.localize,I=e.unescaped),e=>S=e.ShelfConstants]]},["cDcdfi","5X2em-","YL_nOm","RiHMo-","jSLlaY","-i3PJS","Jk5sjx","2R4xv2","pLbCP4","10hEZ1","535agn","11c-TY"]]);
